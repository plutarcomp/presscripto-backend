const otpGenerator = require('./otpGenerator');

async function verifyOtp(identifier, otp) {
  if (!identifier || !otp) {
    throw new Error('Identificador y c√≥digo OTP requeridos');
  }

  console.log('üîç Verificando OTP...');
  console.log('‚û°Ô∏è  Identifier recibido:', identifier);
  console.log('‚û°Ô∏è  OTP recibido:', otp);

  const isValid = otpGenerator.verify(identifier, otp);

  console.log('üß† Resultado de otpGenerator.verify():', isValid);
  console.log('üì¶ Estado actual del OTP Store:', otpGenerator.otpStore);

  if (!isValid) {
    return {
      success: false,
      message: 'OTP inv√°lido o expirado',
    };
  }

  return {
    success: true,
    message: 'OTP verificado correctamente',
  };
}

module.exports = verifyOtp;